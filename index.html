<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCNA 200-301 ูุญุงูู ุงูุงุฎุชุจุงุฑ ุงูุงุญุชุฑุงูู</title>
    <!-- ุชุญููู Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ุฅุนุฏุงุฏ ุฎุท Tajawal ูุฎุท ุนุฑุจู ุงุญุชุฑุงูู ููุงุนู -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800;900&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #eef2ff; /* Indigo-50 - ุฎูููุฉ ุฎูููุฉ */
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .quiz-card {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
            max-width: 600px;
            width: 100%;
        }
        /* ุฎุท ุงุญุชุฑุงูู ููุต ุงูุณุคุงู - ุชู ุชุตุบูุฑ ุญุฌู ุงูุฎุท ูุชุฎููู ูุฒูู */
        #question-text {
            font-family: 'Tajawal', sans-serif;
            font-weight: 600; /* ูุฒู ุฃูู ูู ุงูุณุงุจู */
            font-size: 1.875rem; /* text-3xl ุจุฏูุงู ูู text-4xl */
        }

        /* ุชุฃุซูุฑ 3D ุนูู ุฃุฒุฑุงุฑ ุงูุฎูุงุฑุงุช */
        .option-btn {
            text-align: right;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 2px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .option-btn:hover:not(:disabled) {
            background-color: #e0f2fe; /* Sky-100 */
            transform: translateY(-2px);
            box-shadow: 0 8px 10px -3px rgba(0, 0, 0, 0.15);
        }
        
        /* ุญุงูุงุช ุงูุฅุฌุงุจุฉ */
        .selected-correct {
            background-color: #d1fae5 !important; /* Green-100 */
            border-color: #10b981 !important; /* Green-500 */
            box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3) !important;
        }
        .selected-incorrect {
            background-color: #fee2e2 !important; /* Red-100 */
            border-color: #ef4444 !important; /* Red-500 */
            box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3) !important;
        }
        .disabled {
            cursor: default;
            pointer-events: none;
            opacity: 0.9;
            transform: none !important; /* ุฅูุบุงุก ุงูุชุฑุงูุฒูุดู ุนูุฏ ุงูุชุนุทูู */
        }
        /* ุชุตููู ุฒุฑ ุงูุชุญููู ุงูุฏุงุฆุฑู */
        .spinner {
            border-top-color: #3b82f6;
            -webkit-animation: spinner 1s linear infinite;
            animation: spinner 1s linear infinite;
        }
        @-webkit-keyframes spinner {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <div class="max-w-2xl w-full mx-auto">
        <!-- ุงูุนููุงู ุงูุฑุฆูุณู -->
        <header class="text-center mb-6">
            <h1 class="text-3xl font-extrabold text-gray-800 tracking-wide p-2 bg-indigo-100 rounded-xl shadow-md border-b-2 border-indigo-400">
                CCNA 200-301 v.1.1 ูุญุงูู ุงุฎุชุจุงุฑ ุขูู
            </h1>
        </header>

        <!-- ููุทูุฉ ุงูุนุฑุถ ุงูุฑุฆูุณูุฉ (ุงูุทุจูุฉ ุงููุงุญุฏุฉ) -->
        <main id="quiz-container" class="quiz-card bg-white p-6 md:p-8 rounded-xl border border-gray-200">

            <!-- ูุคุดุฑ ุงูุชุญููู/ุงูุฑุณุงูุฉ ุงูุฃูููุฉ -->
            <div id="loading-state" class="text-center py-20">
                <div class="spinner border-4 border-gray-200 border-solid rounded-full h-12 w-12 mx-auto mb-4"></div>
                <p class="text-lg text-indigo-600 font-semibold">ุฌุงุฑู ุชุญููู ุงูุฃุณุฆูุฉ. ุณูุธูุฑ ุงูุงุฎุชุจุงุฑ ููุฑุงู.</p>
                <p id="loading-subtitle" class="text-sm text-gray-500 mt-2">
                    <span id="mode-message" class="font-bold text-yellow-600">ุฌุงุฑู ูุญุงููุฉ ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุงููููู ุงูุขูู...</span>
                </p>
            </div>

            <!-- ูุญุชูู ุงูุงุฎุชุจุงุฑ (ูุธูุฑ ุจุนุฏ ุงูุชุญููู) -->
            <div id="quiz-content" class="hidden">
                
                <!-- ููุทูุฉ ุจูุงูุงุช ุงููุณุงุฑ -->
                <div class="mb-10 pb-4 border-b border-gray-100 text-center">
                    <span id="domain-display" class="inline-block px-5 py-2 text-xl font-extrabold rounded-full text-white shadow-lg">
                        [ูุณุงุฑ ุงูุณุคุงู]
                    </span>
                </div>

                <!-- ูุต ุงูุณุคุงู (ุชู ุฅุฒุงูุฉ ุฑูู ุงูุณุคุงู ูุชุฎููู ุงูุฎุท) -->
                <div class="mb-10 text-center">
                    <p id="question-text" class="text-3xl font-semibold text-gray-800 leading-snug max-w-xl mx-auto">
                        [ูุต ุงูุณุคุงู ูุธูุฑ ููุง]
                    </p>
                </div>

                <!-- ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ -->
                <div id="options-container" class="space-y-4">
                    <!-- ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ ูุชู ุฅุฏุฑุงุฌูุง ููุง ุจูุงุณุทุฉ JavaScript -->
                </div>

                <!-- ููุทูุฉ ุงูุดุฑุญ ูุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ/ุงูุฎุงุทุฆุฉ -->
                <div id="feedback-area" class="mt-8 p-4 rounded-xl border-r-4 hidden">
                    <div class="flex items-start">
                        <!-- ุฃููููุฉ ุงูุดุฑุญ -->
                        <div id="feedback-icon" class="flex-shrink-0 ml-3 h-8 w-8 rounded-full flex items-center justify-center">
                            <!-- ุงูุฃููููุฉ ุชุธูุฑ ููุง -->
                        </div>
                        <div class="flex-grow">
                            <h3 id="feedback-title" class="font-extrabold text-lg mb-2"></h3>
                            <p id="explanation-text" class="text-md text-gray-700 leading-relaxed"></p>
                        </div>
                    </div>
                </div>

                <!-- ุฃุฒุฑุงุฑ ุงูุณุงุจู/ุงูุชุงูู -->
                <div class="flex justify-between mt-8 pt-6 border-t border-gray-100">
                    <button id="prev-btn" onclick="goToPreviousQuestion()" disabled
                        class="flex items-center px-5 py-2 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 disabled:opacity-50 transition duration-150 shadow-md hover:shadow-lg">
                        <!-- ุฃููููุฉ ุณุงุจูุฉ (ุณูู ูููู) -->
                        <svg class="w-5 h-5 ml-2 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                        ุงูุณุงุจู
                    </button>
                    <button id="next-btn" onclick="goToNextQuestion()" disabled
                        class="flex items-center px-5 py-2 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition duration-150 shadow-md hover:shadow-lg">
                        ุงูุชุงูู
                        <!-- ุฃููููุฉ ุงูุชุงูู (ุณูู ูุณุงุฑ) -->
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                    </button>
                </div>
            </div>

            <!-- ุดุงุดุฉ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ -->
            <div id="results-screen" class="hidden text-center py-12">
                <h2 class="text-4xl font-extrabold text-indigo-700 mb-6">โ ูุชุงุฆุฌ ุงุฎุชุจุงุฑ CCNA</h2>
                <div class="mb-8 p-6 bg-green-50 rounded-xl inline-block border-2 border-green-300 shadow-lg">
                    <p class="text-3xl font-extrabold text-gray-800">
                        ุงููุชูุฌุฉ ุงูููุงุฆูุฉ: <span id="final-score" class="text-green-600"></span> / 10
                    </p>
                </div>
                <p id="result-message" class="text-xl text-gray-700 mb-10 leading-relaxed"></p>
                
                <button onclick="restartQuiz(true)"
                    class="px-8 py-3 bg-blue-600 text-white font-bold text-lg rounded-full shadow-xl hover:bg-blue-700 transition duration-150 transform hover:scale-105">
                    ุจุฏุก ุงุฎุชุจุงุฑ ุฌุฏูุฏ (ุฌูุจ ุฃุณุฆูุฉ ุฌุฏูุฏุฉ ุนุจุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู)
                </button>
                <p class="text-xs text-gray-400 mt-4">ูุฏ ูุชุฃุฎุฑ ุฌูุจ ุงูุฃุณุฆูุฉ ุงูุฌุฏูุฏุฉ ุนุจุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ููููุงู</p>
            </div>

        </main>
    </div>

    <script type="module">
        // ==========================================================
        // ุจูุงูุงุช ุงูุฃุณุฆูุฉ ุงููุญููุฉ (ูุถูุงู ุงูุชุญููู ุงูููุฑู ูุงูุนูู ุฎุงุฑุฌ ุฃู ุจูุฆุฉ)
        // ==========================================================
        const initialQuestions = [
            { "question_text": "ูุง ูู ุฏูุฑ ุจุฑูุชูููู DHCP Snooping ูู ุชุนุฒูุฒ ุฃูุงู ุงูุดุจูุฉ ุนูู ูุญูู Ciscoุ", "domain_ar": "ุฃูู ุงูุดุจูุงุช (Security Fundamentals)", "options": ["ููุน ูุฌูุงุช ุงูุชุญุงู (Spoofing) ูู MAC Address.", "ุงูุชุญูู ูู ุตุญุฉ ุงุณุชุฌุงุจุงุช (DHCPOffer) ูููุน ุฎูุงุฏู DHCP ุงูุงุญุชูุงููุฉ.", "ุชุฃููู ุงููุตูู ุฅูู ูุงุฌูุฉ ุณุทุฑ ุงูุฃูุงูุฑ (CLI) ูููุญูู.", "ููุน ูุฌูุงุช (ARP Poisoning) ูู ุฏุงุฎู ุงูุดุจูุฉ ุงููุญููุฉ."], "correct_index": 1, "explanation_ar": "DHCP Snooping ูููุน ุฎูุงุฏู DHCP ุงูุงุญุชูุงููุฉ ุนู ุทุฑูู ุชุญุฏูุฏ ุงูููุงูุฐ ุงูููุซููุฉ ูุบูุฑ ุงูููุซููุฉ." },
            { "question_text": "ูู ุทูุจูููุฌูุง ุดุจูุฉ (Spine-Leaf) ุงูุญุฏูุซุฉุ ูุง ูู ุงูุฏูุฑ ุงูุฃุณุงุณู ููุญูู (Spine)ุ", "domain_ar": "ุฃุณุงุณูุงุช ุงูุดุจูุงุช (Networking Fundamentals)", "options": ["ุชูููุฑ ููุงูุฐ ูุตูู ููุฃุฌูุฒุฉ ุงูููุงุฆูุฉ (Endpoints) ูุงูุชุญูู ูู VLANs.", "ุงูุนูู ูู Layer 3 Gateway ูุชูููุฑ ุฎุฏูุงุช ุงูุฃูุงู (Firewalling).", "ุฑุจุท ุฌููุน ูุญููุงุช (Leaf) ูุนุงู ูุถูุงู ูุฌูุฏ ูุณุงุฑ ูุงุญุฏ ุฅูู ูู ููุงู.", "ุชูููุฑ ุงููุณุงุฑ ุงูุงูุชุฑุงุถู (Default Gateway) ูุญุฑูุฉ ุงููุฑูุฑ ุงูุฎุงุฑุฌูุฉ."], "correct_index": 2, "explanation_ar": "ุชุนูู ูุญููุงุช Spine ูู 'backbone' ูุฑุจุท ุฌููุน ูุญููุงุช Leaf ูุนูุง ูุถูุงู ูุตูู ุฃู ูุญูู Leaf ุฅูู ุขุฎุฑ ุจุฎุทูุฉ ูุงุญุฏุฉ." },
            { "question_text": "ูุง ูู ููุฒุฉ ุจุฑูุชูููู (Rapid PVST+) ููุงุฑูุฉ ุจู (PVST+)ุ", "domain_ar": "ุงููุตูู ููุดุจูุฉ (Network Access)", "options": ["ุฏุนู ุงูุชูุงุฒู ูู ุชุญููู ุงูุฑูุงุจุท (Load Balancing) ุจุดูู ุงูุชุฑุงุถู.", "ุฃููุงุช ุชูุงุฑุจ (Convergence) ุฃุณุฑุน ุจูุซูุฑ (ุจุถุน ุซูุงู) ุนูุฏ ุญุฏูุซ ุชุบููุฑ ูู ุงูุทูุจูููุฌูุง.", "ุฅููุงููุฉ ุงุณุชุฎุฏุงู STP ููู VLAN ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชูููู ุฎุงุต.", "ุฏุนู ุงูุชูุฏูุณ (Stacking) ูููุญููุงุช ูุชุจุณูุท ุงูุฅุฏุงุฑุฉ."], "correct_index": 1, "explanation_ar": "ูุณุชุฎุฏู RSTP (ุงูุฐู ูู Rapid PVST+) ุขููุงุช ุฃูุถู ูุซู ููุงูุฐ ุงูุญุงูุฉ ูุชูููู ุฒูู ุงูุชูุงุฑุจ ูู 50 ุซุงููุฉ ูู PVST+ ุฅูู ุจุถุน ุซูุงู." },
            { "question_text": "ูุง ูู ูููุงุณ ุงูุชูุฌูู (Metric) ุงูุฐู ูุณุชุฎุฏูู ุจุฑูุชูููู OSPF ูุชุญุฏูุฏ ุฃูุถู ูุณุงุฑุ", "domain_ar": "ุงูู IP Connectivity (ุงูุงุชุตุงู ุนุจุฑ IP)", "options": ["ุนุฏุฏ ุงูููุฒุงุช (Hop Count).", "ุนุฑุถ ุงููุทุงู ุงูุชุฑุฏุฏู (Bandwidth) ุฃู ุงููููุฉ (Cost).", "ุงููุณุงูุฉ ุงูุฅุฏุงุฑูุฉ (Administrative Distance).", "ุฒูู ุงูุชุฃุฎูุฑ (Delay) ูุงูููุซูููุฉ (Reliability)."], "correct_index": 1, "explanation_ar": "ูุณุชุฎุฏู ุจุฑูุชูููู OSPF ููููู 'ุงููููุฉ' (Cost)ุ ููู ูููุฉ ุชูุญุณุจ ุจูุงุกู ุนูู ุนุฑุถ ุงููุทุงู ุงูุชุฑุฏุฏู (Bandwidth) ููุฑุงุจุท. ูููุง ุฒุงุฏุช ุงูุณุฑุนุฉุ ููุช ุงููููุฉ." },
            { "question_text": "ุฃู ูู ุฎุฏูุงุช IP ุงูุชุงููุฉ ุชุณูุญ ูููุณุชุฎุฏู ุจุชุฎุตูุต ูุทุงู ูู ุงูู IP Address ูุงุณุชุฎุฏุงููุง ููุตุฏุฑ ูุญุฑูุฉ ูุฑูุฑ (NAT Overload)ุ", "domain_ar": "ุงูู IP Services (ุฎุฏูุงุช IP)", "options": ["Static NAT.", "Port Address Translation (PAT).", "Dynamic NAT.", "Policy-Based Routing (PBR)."], "correct_index": 2, "explanation_ar": "ูุณุชุฎุฏู Dynamic NAT ูุฌููุนุฉ ูู ุนูุงููู IP ุงูุนุงูุฉ ูุชุนููููุง ุจุงูุชุณูุณู ูููุณุชุฎุฏููู ุงูุฏุงุฎูููู." },
            { "question_text": "ุนูุฏูุง ูููู ูุณุคูู ุดุจูุฉ ุจุชุทุจูู ูุงุฆูุฉ ูุตูู ููุงุณูุฉ (Standard ACL) ุนูู ููุฌูุ ูุง ูู ุงูุชูุตูุฉ ุจุฎุตูุต ูููุน ุชุทุจูููุงุ", "domain_ar": "ุฃูู ุงูุดุจูุงุช (Security Fundamentals)", "options": ["ุฃูุฑุจ ูุง ูููู ุฅูู ุงููุตุฏุฑ (Source).", "ุฃูุฑุจ ูุง ูููู ุฅูู ุงููุฌูุฉ (Destination).", "ููุท ุนูู ูุงุฌูุงุช ุงูุฅุฎุฑุงุฌ (Outbound Interfaces).", "ููุท ุนูู ูุงุฌูุงุช ุงูุฅุฏุฎุงู (Inbound Interfaces)."], "correct_index": 1, "explanation_ar": "Standard ACLs ุชูุฑุดุญ ุจูุงุกู ุนูู ุงููุตุฏุฑ ููุทุ ูุฐูู ุชูุถุน ุฃูุฑุจ ูุง ูููู ุฅูู ุงููุฌูุฉ ูุชูููู ุชุฃุซูุฑูุง ุนูู ุญุฑูุฉ ุงููุฑูุฑ." },
            { "question_text": "ูู ุณูุงู ุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู SNMPุ ูุง ูู ุงูุจุฑูุชูููู ุงูุฐู ูุณุชุฎุฏูู (SNMP Manager) ูุฅุฑุณุงู ุฑุณุงุฆู ุงุณุชุนูุงู (Query) ุฅูู (SNMP Agent)ุ", "domain_ar": "ุงูู IP Services (ุฎุฏูุงุช IP)", "options": ["TCP", "ICMP", "UDP", "RTP"], "correct_index": 2, "explanation_ar": "ูุณุชุฎุฏู ุจุฑูุชูููู SNMP ุจุฑูุชูููู UDP (User Datagram Protocol) ููููุฐ 161 ููุงุณุชุนูุงูุงุช ููููุฐ 162 ููู Traps." },
            { "question_text": "ุฃู ุชูููุฉ ุชููู ูููุฏุณ ุงูุดุจูุฉ ูู ุงุณุชุฎุฏุงู ุฃูุงูุฑ Python ููุชุญูู ูุชูููู ุฃุฌูุฒุฉ Ciscoุ ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ุฃูุงูุฑ CLI ุงูุชูููุฏูุฉุ", "domain_ar": "ุงูุชุญูู ูุงูุฃุชูุชุฉ (Automation and Programmability)", "options": ["SSH with Telnet.", "SNMP Traps.", "RESTCONF API.", "NTP Synchronization."], "correct_index": 2, "explanation_ar": "RESTCONF ูู ุจุฑูุชูููู ูุงุฆู ุนูู RESTful ูุณูุญ ูููุทูุฑูู ูุงููููุฏุณูู ุจุงุณุชุฎุฏุงู ูุบุงุช ุงูุจุฑูุฌุฉ ูุฅุฏุงุฑุฉ ูุชูููู ุฃุฌูุฒุฉ ุงูุดุจูุฉ." },
            { "question_text": "ุนูุฏูุง ูููู ููุฌู Cisco ุจุฅูุดุงุก ุนููุงู IPv6 ูุญูู ููุฑุงุจุท (Link-Local Address) ุชููุงุฆูุงูุ ูุง ูู ุงูุชูููุฉ ุงูุชู ูุณุชุฎุฏููุง ูุชุญููู MAC Address ุงูุฎุงุต ุจุงููุงุฌูุฉ ุฅูู ุฌุฒุก ุงูู Interface ID ูุนููุงู IPv6ุ", "domain_ar": "ุงูู IP Connectivity (ุงูุงุชุตุงู ุนุจุฑ IP)", "options": ["SLAAC", "Modified EUI-64", "DHCPv6 Stateful", "Randomization"], "correct_index": 1, "explanation_ar": "ุชุนุชุจุฑ Modified EUI-64 ูู ุงูุขููุฉ ุงูุงูุชุฑุงุถูุฉ ูุชุญููู 48 ุจุช ูู MAC Address ุฅูู 64 ุจุช ูู ุงูู Interface ID ูู IPv6." },
            { "question_text": "ูุง ูู ุฃูู ุฅุฌุฑุงุก ูุฌุจ ุงุชุฎุงุฐู ุนูุฏ ุงุณุชูุดุงู ุฃุฎุทุงุก (Troubleshooting) ูุดููุฉ ุงุชุตุงู ูู ุงูุดุจูุฉ ุงููุญููุฉ (LAN) ูููุงู ููููุฐุฌ OSIุ", "domain_ar": "ุงุณุชูุดุงู ุงูุฃุฎุทุงุก (Troubleshooting)", "options": ["ุงูุชุญูู ูู ุฌุฏุงูู ุงูุชูุฌูู (Routing Tables).", "ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ (Ping).", "ุงูุชุญูู ูู ุญุงูุฉ ุงูุฑูุงุจุท ูุงููุงุจูุงุช (ุงูุทุจูุฉ ุงูููุฒูุงุฆูุฉ).", "ุงูุชุญูู ูู ุนููุงู IP ูููุงุน ุงูุดุจูุฉ (Subnet Mask)."], "correct_index": 2, "explanation_ar": "ุนูุฏ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู ูููุฐุฌ OSIุ ุชุจุฏุฃ ุฏุงุฆูุงู ูู ุงูุทุจูุฉ ุงูุณูููุฉ (ุงูุทุจูุฉ ุงูููุฒูุงุฆูุฉ 1)." }
        ];
        // ==========================================================

        // ูุชุบูุฑ ุซุงุจุช ูุดูุฑ ุฅูู ููุทุฉ ุงูููุงูุฉ ุงูุขููุฉ ููุฎุงุฏู ุงููููู
        const PROXY_URL = "/api/generate-quiz";
        const MAX_RETRIES = 3;

        // ุงููุชุบูุฑุงุช ุงูุนุงูููุฉ ููุญุงูุฉ
        let questions = []; 
        let currentQuestionIndex = 0;
        let userAnswers = [];

        // ุงูุนูุงุตุฑ ุงูุฑุฆูุณูุฉ ูู DOM
        const loadingState = document.getElementById('loading-state');
        const loadingSubtitle = document.getElementById('loading-subtitle');
        const modeMessage = document.getElementById('mode-message');
        const quizContent = document.getElementById('quiz-content');
        const resultsScreen = document.getElementById('results-screen');
        const domainDisplay = document.getElementById('domain-display');
        const questionTextElement = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackArea = document.getElementById('feedback-area');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackIcon = document.getElementById('feedback-icon');
        const explanationText = document.getElementById('explanation-text');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');


        /**
         * ุฏุงูุฉ ูุฌูุจ ุงูุฃุณุฆูุฉ ุงูุฌุฏูุฏุฉ ูู ุงูุฎุงุฏู ุงููููู ุงูุขูู (ูุน ุขููุฉ ุงูุชุฑุงุฌุน ุงูุฃุณู)
         */
        async function fetchQuestionsFromAPI() {
            loadingSubtitle.textContent = 'ุฌุงุฑู ุชูููุฏ ุฃุณุฆูุฉ ุงุญุชุฑุงููุฉ ูุตููุฉ ุจูุงุณุทุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู... (ูุฏ ูุณุชุบุฑู 5-15 ุซุงููุฉ)';
            modeMessage.className = 'font-bold text-yellow-600';
            modeMessage.textContent = 'ุฌุงุฑู ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุงููููู... ุงูููุชุงุญ ูุฎูู ูุขูู.';

            let currentRetry = 0;

            while (currentRetry < MAX_RETRIES) {
                try {
                    // ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุงููููู ุงูุขูู
                    const response = await fetch(PROXY_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                    });

                    if (!response.ok) {
                        const errorBody = await response.json().catch(() => ({ error: 'Unknown Proxy Error' }));
                        throw new Error(`Proxy error! status: ${response.status}. Message: ${errorBody.error || 'Unknown error'}`);
                    }

                    const result = await response.json();
                    
                    // ุงูุฎุงุฏู ุงููููู ูุฑุฌุน ุงููุงุฆู { questions: [...] }
                    if (result.questions && Array.isArray(result.questions) && result.questions.length > 0) {
                        questions = result.questions.map(q => ({
                            ...q,
                            userAnswerIndex: null,
                            isCorrect: null,
                        }));
                        
                        userAnswers = new Array(questions.length).fill(null).map(() => ({
                            answeredIndex: null,
                            isCorrect: null
                        }));
                        
                        modeMessage.className = 'font-bold text-green-600';
                        modeMessage.textContent = 'โ ุชู ุชุญููู ุฃุณุฆูุฉ ุฌุฏูุฏุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู (ุงูุงุชุตุงู ุขูู).';
                        return true; // ูุฌุงุญ ุงูุนูููุฉ
                    } else {
                         throw new Error("ุงูุฎุงุฏู ุงููููู ูู ูุฑุฌุน ุจูุงูุงุช ุฃุณุฆูุฉ ุตุงูุญุฉ.");
                    }
                } catch (error) {
                    console.error(`Attempt ${currentRetry + 1} failed:`, error);
                    currentRetry++;
                    if (currentRetry < MAX_RETRIES) {
                        const delay = Math.pow(2, currentRetry) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        // ุงููุดู ุจุนุฏ ูู ุงููุญุงููุงุช - ุงูุนูุฏุฉ ุฅูู ุงูุฃุณุฆูุฉ ุงููุญููุฉ
                        console.error('ูุดู ุฌูุจ ุงูุฃุณุฆูุฉ ุงูุฌุฏูุฏุฉ ุจุนุฏ ุนุฏุฉ ูุญุงููุงุช.');
                        return false; 
                    }
                }
            }
            return false;
        }

        /**
         * ุฏุงูุฉ ูุชููุฆุฉ ุงูุฃุณุฆูุฉ (ุณูุงุก ูู ุงููุญููุฉ ุฃู API)
         * @param {boolean} useApi - ุฅุฐุง ูุงู ุตุญูุญูุงุ ุณูุญุงูู ุฌูุจ ุฃุณุฆูุฉ ุฌุฏูุฏุฉ ุนุจุฑ API.
         */
        async function initializeQuestions(useApi = false) {
            loadingState.classList.remove('hidden');
            quizContent.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            
            currentQuestionIndex = 0;
            
            let success = false;
            if (useApi) {
                success = await fetchQuestionsFromAPI();
            }

            if (!success) {
                // ุงูุชุญููู ุงูููุฑู ูู ุงูุจูุงูุงุช ุงููุญููุฉ
                questions = initialQuestions.map(q => ({
                    ...q,
                    userAnswerIndex: null,
                    isCorrect: null,
                }));

                userAnswers = new Array(questions.length).fill(null).map(() => ({
                    answeredIndex: null,
                    isCorrect: null
                }));
                
                modeMessage.className = 'font-bold text-red-600';
                modeMessage.textContent = 'โ๏ธ ูุดู ุฌูุจ ุงูุฃุณุฆูุฉ ุงูุฌุฏูุฏุฉ. ุชู ุชุญููู ุงูุฃุณุฆูุฉ ุงููุฏูุฌุฉ (ุงููุญููุฉ).';
            }

            // ุนุฑุถ ุงูุงุฎุชุจุงุฑ
            displayQuestion();
            loadingState.classList.add('hidden');
            quizContent.classList.remove('hidden');
        }

        /**
         * ุนุฑุถ ุงูุณุคุงู ุงูุญุงูู
         */
        function displayQuestion() {
            if (questions.length === 0 || currentQuestionIndex < 0 || currentQuestionIndex >= questions.length) {
                return;
            }

            const q = questions[currentQuestionIndex];
            const answerState = userAnswers[currentQuestionIndex];
            
            const questionNumberDisplay = document.querySelector('.quiz-card');
            if (questionNumberDisplay) {
                questionNumberDisplay.setAttribute('data-question-index', currentQuestionIndex + 1); 
            }

            domainDisplay.textContent = q.domain_ar;
            domainDisplay.className = `inline-block px-5 py-2 text-xl font-extrabold rounded-full text-white shadow-lg ${getDomainColor(q.domain_ar)}`;

            // ุชุญุฏูุซ ูุต ุงูุณุคุงู
            questionTextElement.textContent = q.question_text;

            // ุชุญุฏูุซ ุงูุฎูุงุฑุงุช
            optionsContainer.innerHTML = '';
            const optionLetters = ['ุฃ', 'ุจ', 'ุฌ', 'ุฏ'];
            q.options.forEach((option, index) => {
                const isSelected = answerState.answeredIndex === index;
                let classes = 'option-btn w-full p-4 rounded-lg text-gray-800 font-medium transition duration-150';

                if (answerState.answeredIndex !== null) {
                    if (index === q.correct_index) {
                        classes += ' selected-correct';
                    } else if (isSelected && answerState.isCorrect === false) {
                        classes += ' selected-incorrect';
                    } else {
                        classes += ' bg-gray-50 border-gray-200';
                    }
                    classes += ' disabled';
                } else {
                    classes += ' bg-white hover:border-blue-400';
                }

                optionsContainer.innerHTML += `
                    <button class="${classes}" data-index="${index}" ${answerState.answeredIndex !== null ? 'disabled' : ''} onclick="handleAnswerSelection(${index})">
                        <span class="ml-3 font-mono text-lg font-extrabold">${optionLetters[index]}.</span> ${option}
                    </button>
                `;
            });
            
            updateFeedbackArea();
            updateNavigationButtons();
        }

        /**
         * ุฏุงูุฉ ุจุณูุทุฉ ูุชุญุฏูุฏ ููู ุงููุณุงุฑ (ูุชุญุณูู ุงูุงุญุชุฑุงููุฉ ุงูุจุตุฑูุฉ)
         */
        function getDomainColor(domain) {
            if (domain.includes('ุฃุณุงุณูุงุช ุงูุดุจูุงุช')) return 'bg-indigo-600';
            if (domain.includes('ุงููุตูู ููุดุจูุฉ')) return 'bg-purple-600';
            if (domain.includes('IP Connectivity')) return 'bg-sky-600';
            if (domain.includes('IP Services')) return 'bg-yellow-600';
            if (domain.includes('ุฃูู ุงูุดุจูุงุช')) return 'bg-red-600';
            if (domain.includes('ุงูุฃุชูุชุฉ')) return 'bg-teal-600';
            if (domain.includes('ุงุณุชูุดุงู ุงูุฃุฎุทุงุก')) return 'bg-gray-600';
            return 'bg-blue-500';
        }
        
        /**
         * ุญุณุงุจ ุงููุชูุฌุฉ ุงูุฅุฌูุงููุฉ
         */
        function calculateScore() {
            return userAnswers.filter(a => a.isCorrect === true).length;
        }
        
        /**
         * ูุนุงูุฌุฉ ุงุฎุชูุงุฑ ุงูุฅุฌุงุจุฉ
         */
        window.handleAnswerSelection = function(selectedIndex) {
            if (userAnswers[currentQuestionIndex].answeredIndex !== null) return;
            
            const q = questions[currentQuestionIndex];
            const isCorrect = selectedIndex === q.correct_index;
            
            userAnswers[currentQuestionIndex].answeredIndex = selectedIndex;
            userAnswers[currentQuestionIndex].isCorrect = isCorrect;
            
            displayQuestion(); 
            updateNavigationButtons();
        }

        /**
         * ุชุญุฏูุซ ููุทูุฉ ุงูุดุฑุญ ูุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ
         */
        function updateFeedbackArea() {
            const q = questions[currentQuestionIndex];
            const answerState = userAnswers[currentQuestionIndex];
            
            if (answerState.answeredIndex !== null) {
                feedbackArea.classList.remove('hidden');
                
                if (answerState.isCorrect) {
                    feedbackArea.className = 'mt-8 p-4 rounded-xl border-r-4 border-green-500 bg-green-50';
                    feedbackTitle.className = 'font-extrabold text-lg mb-2 text-green-700';
                    feedbackTitle.textContent = 'ุฅุฌุงุจุฉ ุตุญูุญุฉ! ๐';
                    feedbackIcon.innerHTML = `<svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`;
                } else {
                    feedbackArea.className = 'mt-8 p-4 rounded-xl border-r-4 border-red-500 bg-red-50';
                    feedbackTitle.className = 'font-extrabold text-lg mb-2 text-red-700';
                    feedbackTitle.textContent = 'ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ! โ';
                    feedbackIcon.innerHTML = `<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`;
                }

                explanationText.textContent = q.explanation_ar;

            } else {
                feedbackArea.classList.add('hidden');
            }
        }

        /**
         * ุชุญุฏูุซ ุญุงูุฉ ุฃุฒุฑุงุฑ ุงูุชููู
         */
        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            
            const isAnswered = userAnswers[currentQuestionIndex].answeredIndex !== null;
            const isLastQuestion = currentQuestionIndex === questions.length - 1;

            if (isLastQuestion) {
                nextBtn.innerHTML = `ุนุฑุถ ุงููุชูุฌุฉ <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>`;
                nextBtn.onclick = showResults;
            } else {
                nextBtn.innerHTML = `ุงูุชุงูู <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>`;
                nextBtn.onclick = goToNextQuestion;
            }
            nextBtn.disabled = !isAnswered; 
        }

        /**
         * ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุชุงูู
         */
        window.goToNextQuestion = function() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            } else if (currentQuestionIndex === questions.length - 1) {
                showResults();
            }
        }

        /**
         * ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุณุงุจู
         */
        window.goToPreviousQuestion = function() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        /**
         * ุนุฑุถ ุดุงุดุฉ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ
         */
        function showResults() {
            const finalScore = calculateScore();
            quizContent.classList.add('hidden');
            resultsScreen.classList.remove('hidden');

            document.getElementById('final-score').textContent = finalScore;

            let message = '';
            if (finalScore === questions.length) {
                message = 'ูุชูุฌุฉ ุฎุงุฑูุฉ! ุนุดุฑุฉ ูู ุนุดุฑุฉ. ูุณุชูุงู ุงูุงุญุชุฑุงูู ูุง ูุณุชูุงู ุจู.';
            } else if (finalScore >= questions.length * 0.8) {
                message = 'ุฃุฏุงุก ุฑุงุฆุน! ุฃูุช ูุฑูุจ ุฌุฏุงู ูู ุงูุฅุชูุงู. ุงุณุชูุฑ ูู ูุฑุงุฌุนุฉ ููุงุท ุงูุถุนู ุงูููููุฉ.';
            } else if (finalScore >= questions.length * 0.6) {
                message = 'ุฃุฏุงุก ุฌูุฏ ูููุจูู. ูุฏูู ุฃุณุงุณ ูุชููุ ูููู ุชุญุชุงุฌ ุฅูู ุชุฑููุฒ ุฅุถุงูู ุนูู ุงููุณุงุฑุงุช ุงูุตุนุจุฉ.';
            } else {
                message = 'ุชุญุชุงุฌ ุฅูู ูุฑุงุฌุนุฉ ุดุงููุฉ ูุฃุณุงุณูุงุช CCNA. ูุง ุชูุฃุณุ ุงูุนุฒููุฉ ูุงูููุงุฑุณุฉ ูู ุทุฑููู ูููุฌุงุญ.';
            }
            document.getElementById('result-message').textContent = message;
        }

        /**
         * ุฅุนุงุฏุฉ ุจุฏุก ุงูุงุฎุชุจุงุฑ (ูุณุชุฎุฏู ุงูุฃุณุฆูุฉ ุงููุญููุฉ ุฃู ูุฌูุจ ุงูุฌุฏูุฏุฉ ุญุณุจ ุงูุทูุจ)
         * @param {boolean} fetchNew - ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ูุฌุจ ุฌูุจ ุฃุณุฆูุฉ ุฌุฏูุฏุฉ ุนุจุฑ API
         */
        window.restartQuiz = function(fetchNew = false) {
            initializeQuestions(fetchNew);
        }

        // ุจุฏุก ุงูุชุทุจูู ุจุงูุฃุณุฆูุฉ ุงููุญููุฉ ูุถูุงู ุงูุชุญููู ุงูููุฑู
        initializeQuestions(false);
    </script>
</body>
</html>

